# `CSS`工作原理

## 1 添加样式的三种方法

- 行内样式：写在特定HTML标签的style属性里。行内样式只能影响它所在的标签，而且总会覆盖嵌入样式和连接样式。

~~~html
<p style="color: red;"></p>
~~~

- 嵌入样式：放在HTML文档的head元素中。嵌入样式的应用范围仅限于本页面。它会覆盖外部样式表中的样式，但会被行内样式所覆盖。

~~~html
<head>
    <style type="text/css">
        p { color: red; }
    </style>
</head>
~~~

- 链接样式：放在一个单独的文件（样式表）中，使用`<link>`标签将样式表链接到页面中。它的作用范围可以是整个网站。

~~~html
<link href="style.css" rel="stylesheet" type="text/css" />
~~~

- `@import`指令：它必须出现在样式表中其他样式之前，否则`@import`引用的样式表不会被加载。

~~~html
@import url(css/style.css)
~~~

`CSS`是通过`<style>`标签嵌入到页面里的。当浏览器遇到开标签`<style>`时，就会由解释HTML代码切换为解释`CSS`代码。当遇到闭标签`</style>`时，再切换回解释HTML代码。对于样式表中的样式，不需要`<style>`标签。

## 2 `CSS`选择符

### 2.1 上下文选择符：基于祖先或同胞元素选择元素

​	上下文选择符也叫后代组合式选择符，就是一组以空格分隔的标签名。用于选择作为指定祖先元素后代的标签。

~~~css
标签1  标签2 { 声明 }
~~~

​	其中，标签2是我们想要选择的目标，而且只有在标签1是其祖先元素（不一定是父元素）的情况下才会被选中。

#### 2.1.1 子选择符>

~~~css
标签1 > 标签2 { 声明 }
~~~

​	标签2必须是标签1的子元素，标签1只能是标签2的父元素才会被选择。

#### 2.1.2 紧邻同胞选择符+

~~~css
标签1 + 标签2 { 声明 }
~~~

​	标签2必须紧跟在其同胞标签1的后面。

#### 2.1.3 一般同胞选择符~

~~~css
标签1 ~ 标签2 { 声明 }
~~~

​	标签2必须跟，不一定紧跟在其同胞标签1的后面。

#### 2.1.4 通用选择符*

~~~css
* { 声明 }
~~~

​	它能匹配任何元素。不过，一般在使用该选择符时，都会同时使用另一个选择符。如用它来选择非子元素：

~~~css
p * a { font-size: 1.3em; }
~~~

​	这条规则将会选中任何是`<p>`的孙子元素，而不是子元素的`<a>`标签。

### 2.2 ID和类选择符：基于id和class属性值选择元素

### 2.2.1 类选择符

~~~css
.类名 { 声明 }
~~~

`	.`和类名之间不能存在空格。

​	组合标签名和类选择符，可以更精确的选择特定的标签：

~~~css
p.specialtext { color: red; }
~~~

​	HTML的`class`属性可以有多个空格分隔的值，要选择同时存在多个类名的元素，可以这样写：

~~~css
.类名1.类名2.类名3.类名n { 声明 }
~~~

​	类名与类名之间没有空格，因为我们只想选择同时具有多个类名的元素。如果加了空格，就会变成“祖先/后代”关系的上下文选择符。

#### 2.2.2 ID选择符

~~~css
#ID { 声明 }
~~~

**小知识：用于页内导航的ID：**

`ID可以用于页面导航链接中。如<a href="#bio">Biography</a>,这个链接通过使用带#的href属性值，表示链接的目标在当前页面中，因而不会触发浏览器加载页面（如果没有#，浏览器就会尝试加载bio目录下的默认页面）。同时，这个页面的下方应该有一个对应的目标元素，比如<h2 id="bio">Biography</h2>。这样，当点击上面的链接时，页面就会滚动到id值为bio的h2元素的位置。如果链接的href属性里只有一个#，那么点击链接就会返回页面顶部。注意，因为href属性值为空的链接的行为跟正常链接不一样，所以不要把href属性留空。`

#### 2.2.3 ID和类的小结

​	ID的用途是在页面中唯一的标识一个元素。利用唯一的ID，可以在`CSS`中方便的定位到这个元素，以及它的子元素。我们经常会给页面中的每个顶级区域都添加一个ID，从而得到非常明确的上下文，以便编写`CSS`时只选择嵌套在相应区域中的标签。

​	类的目的是为了标识一组具有相同特征的元素。

### 2.3 属性选择符：基于属性的有无或特征选择元素

#### 2.3.1 属性名选择符

~~~css
标签名[属性名]
~~~

​	选择任何带有属性名的标签名

#### 2.3.2 属性值选择符

~~~css
标签名[属性名=“属性值”]
~~~

​	选择任何带有值为属性值的属性名的标签名。`HTML5`中，属性值的引号可加可不加。

### 2.4 伪类

#### 2.4.1 `UI`伪类：会在HTML元素处于某个状态时（比如鼠标悬停），为该元素应用`CSS`样式

​	`UI`伪类会基于特定HTML元素的状态应用样式。可以分为

- 链接伪类：一共有4个，链接会始终处于这4个状态之一（`Link：链接等待用户点击；Visited：用户此前点击过这个链接；Hover：鼠标悬停在链接上；Active：链接正在被点击，鼠标按下没有释放`）。

  这些状态对应的4个伪类选择符为：

~~~css
a:link {}
a:visited {}
a:hover {}
a:active {}
~~~

​	**由于这4个伪类的特指度相同，如果不按照这里列出的顺序使用它们，浏览器可能不会显示预期的效果。有些伪类可以用于任何元素，而不仅仅是<a>元素，如hover。**

- `:focus`伪类：元素获取焦点状态时应用样式；
- `：target`伪类：如果用户点击一个指向页面中其他元素的链接，则那个元素就是目标，可以用`:target`伪类选中它。

~~~html
<style>
    #more_info:target { background: #eee; }
</style>

<a href="#more_info">More Information</a>
<h2 id="more_info">
    This is the information you are looking for.
</h2>
~~~

​	它会在用户点击链接转向ID为`more_info`的元素时，为该元素添加浅灰色背景。

#### 2.4.2 结构化伪类：会在标记中存在某种结构上的关系时（比如某个元素是一组元素中的第1个或最后一个），为相应元素应用`CSS`样式

- `:first-child`和`:last-child`

  `:first-child`表示一组同胞元素中的第一个元素，而`:last-child`表示最后一个元素。

- `:nth-child`

~~~css
e:nth-child(n)
~~~

​	`e`表示元素名，`n`表示一个数值（也可以使用`odd`和`even`）。

### 2.5 伪元素

​	伪元素就是文档中若有实无的元素。**一个冒号表示伪类，两个冒号表示`CSS3`中新增的伪元素。尽管浏览器目前都支持对`CSS1`和`CSS2`的伪元素使用一个冒号，还是希望能够使用两个冒号表示伪元素。**

- `::first-letter:`首字符；
- `::first-line:`首行；
- `::before`和`::after`： 用于在特定元素前面或后面添加特殊内容；

### 2.6 继承

​	`CSS`中有很多属性是可以继承的，其中相当一部分都跟文本有关，比如颜色、字体、字号。也有很多属性不能被继承，因为继承这些属性没有意义。不能继承的属性主要涉及元素盒子的定位和显示方式，比如边框、外边距、内边距等。

### 2.7 层叠

​	层叠是一种样式在文档层次中逐层叠加的过程，目的是让浏览器面对某个标签特定属性值的多个来源，确定最终使用哪个值。

​	浏览器层叠各个来源样式的顺序：

- 浏览器默认样式表

- 用户样式表

- 作者链接样式表，按照它们链接到页面的先后顺序

- 作者嵌入样式

- 作者行内样式

  浏览器会按照上述顺序依次检查每个来源的样式，并在有定义的情况下，更新对每个标签属性值的设定。整个检查更新过程结束后，再将每个标签以最终设定的样式显示出来。

#### 2.7.1 层叠规则

- 规则一：找到应用给每个元素和属性的所有声明。

- 规则二：按照顺序和权重排序。

  浏览器会按照之前介绍的来源顺序设定属性值。声明也可以有权重，用下面这样的声明增加权重：

~~~css
p { color: green; !important; font-size: 12pt; }
~~~

​	空格`!important;`用于加重声明的权重，实际上就是一种特权，就应用这个样式了。不过在使用它之前一定要慎重考虑，它很可能会让用户的个人设定不起作用，而这个设定对用户来说可能相当重要。

- 规则三：按特指度排序。特指度其实表示一条规则有多明确。一条规则的特指度，由它的选择符中包含多少个标签、类名和ID决定。

  **计算特指度：**

  ~~~
  首先，有一个记分规则，即对每个选择符都按下面的“I-C-E”公式计算三个值：
  1、选择符中有一个ID，就在I的位置上加1；
  2、选择符中有一个类，就在C的位置上加1；
  3、选择符中有一个元素名，就在E的位置上加1；
  4、得到一个三位数。
  p									0-0-1特指度=1
  p.largettext						0-1-1特指度=11
  p#largetext							1-0-1特指度=101
  body p#largettext					1-0-2特指度=102
  body p#largettext ul.mylist			1-1-3特指度=113
  body p#largettext ul.mylist li		1-1-4特指度=114
  ~~~

- 规则四：顺序决定权重。如果两条规则都影响某元素的同一个属性，而且它们的特指度也相同，则位置最靠下的规则胜出。